# 🚀 自动日课功能 - 快速检查指南

## 立即检查的关键点

### 1️⃣ 模板管理界面（最重要）

**位置**：设置 → 每日回顾 → 日课模板

**检查项**：
```
✓ 新建模板 → 添加日课项
✓ 看到类型选择下拉框：✋ 手动 / ⚡ 自动
✓ 选择"自动"后，出现配置按钮（⚡ 图标）
✓ 点击配置按钮，弹出配置对话框
✓ 配置对话框包含：
  - 日课名称输入框
  - 筛选条件输入框
  - 判断类型下拉（总时长/最早开始时间/最早结束时间）
  - 比较运算符下拉
  - 目标值输入（时长或时间）
  - 规则预览
✓ 保存配置后，显示蓝色规则预览条
✓ 保存模板成功
```

**快速测试**：
```
1. 创建一个自动日课："学习时长达标"
   - 筛选条件：#学习（或你的学习标签）
   - 判断类型：总时长
   - 运算符：>=
   - 目标值：1 小时 0 分钟
   
2. 保存模板
```

---

### 2️⃣ 日报界面

**位置**：打开今天的日报 → 日课标签

**检查项**：
```
✓ 自动日课显示蓝色复选框
✓ 显示"自动"标签（蓝色背景）
✓ 点击自动日课不会切换状态
✓ 手动日课仍然可以正常点击切换
```

**快速测试**：
```
1. 确保今天有一些学习活动记录（总时长 > 1小时）
2. 打开日报 → 日课标签
3. 检查"学习时长达标"是否自动标记为完成（蓝色实心）
4. 如果学习时长 < 1小时，应该是未完成（蓝色空心）
```

---

### 3️⃣ 状态自动更新

**测试步骤**：
```
1. 打开日报，查看自动日课状态（假设未完成）
2. 添加一些学习活动，使总时长 > 1小时
3. 关闭日报
4. 重新打开日报 → 日课标签
5. 检查自动日课是否变为完成状态
```

---

## 🔍 重点检查的文件

### 已修改的核心文件

1. **src/types.ts**
   - 检查 `CheckItem` 和 `CheckTemplateItem` 是否有 `type` 和 `autoConfig` 字段
   - 检查 `AutoCheckConfig` 接口定义

2. **src/views/CheckTemplateManageView.tsx**
   - 检查是否导入了 `CheckTemplateItemRow`
   - 检查 `handleUpdateItem` 的签名是否改为接收 `CheckTemplateItem`
   - 检查 `handleSave` 中是否有自动日课验证逻辑

3. **src/views/DailyReviewView.tsx**
   - 检查是否导入了 `updateAutoCheckItems`
   - 检查是否有 `useEffect` 自动更新日课状态
   - 检查 `handleToggleCheckItem` 是否阻止自动日课切换
   - 检查日课显示部分是否有蓝色样式和"自动"标签

4. **src/hooks/useReviewManager.ts**
   - 检查创建日报时是否保留 `type` 和 `autoConfig` 字段

### 新增的文件

5. **src/utils/autoCheckUtils.ts**
   - 核心判断逻辑
   - 可以运行一下确保没有语法错误

6. **src/components/AutoCheckItemEditor.tsx**
   - 自动日课配置对话框
   - 检查是否能正常打开和保存

7. **src/components/CheckTemplateItemRow.tsx**
   - 日课项编辑行组件
   - 检查类型切换和配置按钮是否正常

---

## 🎯 最简单的验证流程

### 5 分钟快速验证

```
1. 打开应用
   ↓
2. 设置 → 每日回顾 → 日课模板
   ↓
3. 新建模板 → 添加日课项
   ↓
4. 选择"⚡ 自动"类型
   ↓
5. 点击配置按钮（⚡）
   ↓
6. 配置规则：
   - 筛选条件：#学习
   - 判断类型：总时长
   - 运算符：>=
   - 目标值：1 小时
   ↓
7. 保存配置 → 保存模板
   ↓
8. 打开今天的日报 → 日课标签
   ↓
9. 检查自动日课是否显示（蓝色 + "自动"标签）
   ↓
10. 检查完成状态是否正确
```

---

## ⚠️ 可能遇到的问题

### 问题 1：配置对话框不显示
**原因**：可能是导入路径错误或组件未正确渲染
**检查**：浏览器控制台是否有错误信息

### 问题 2：自动日课状态不更新
**原因**：可能是筛选条件不匹配或 useEffect 未触发
**检查**：
- 筛选条件是否正确（标签/领域是否存在）
- 是否有匹配的活动记录
- 浏览器控制台是否有错误

### 问题 3：保存模板失败
**原因**：可能是验证逻辑问题
**检查**：
- 是否配置了自动规则
- 错误提示是什么

### 问题 4：类型切换不工作
**原因**：可能是事件处理问题
**检查**：浏览器控制台是否有错误

---

## 📝 检查清单（打印版）

```
□ 模板管理界面能打开
□ 能看到类型选择（手动/自动）
□ 选择自动后能看到配置按钮
□ 配置对话框能正常打开
□ 能输入筛选条件
□ 能选择判断类型
□ 能设置目标值
□ 能保存配置
□ 能看到规则预览
□ 能保存模板
□ 日报中能看到自动日课
□ 自动日课有蓝色样式
□ 自动日课有"自动"标签
□ 自动日课不能手动切换
□ 自动日课状态正确
□ 添加活动后状态会更新
□ 手动日课仍然正常工作
```

---

## 🎉 如果一切正常

恭喜！自动日课功能已经成功实现。你可以：

1. 创建更多自动日课模板
2. 测试不同的判断类型
3. 查看数据统计中的完成情况
4. 体验智能化的习惯追踪

---

## 📞 需要帮助？

如果遇到问题，请提供：
1. 具体的错误信息（浏览器控制台）
2. 操作步骤
3. 预期行为 vs 实际行为
4. 截图（如果可能）

我会帮你快速定位和解决问题！
