# 日课功能 UI 交互指南

## 交互流程

### 1. 类型切换（手动 ↔ 自动）

**位置**：日课项左侧的图标按钮

**图标说明**：
- 🖐️ 手掌图标 = 手动类型（灰色背景）
- ⚡ 闪电图标 = 自动类型（蓝色背景）

**交互方式**：
- 点击图标即可切换类型
- 手动 → 自动：图标从手掌变为闪电，下方出现配置区域
- 自动 → 手动：图标从闪电变为手掌，下方配置区域消失，自动配置被清除

**示例**：
```
初始状态（手动）：
┌────────────────────────────────────┐
│ 1 [🖐️] [输入日课内容...    ] [×] │
└────────────────────────────────────┘

点击图标后（自动）：
┌────────────────────────────────────┐
│ 1 [⚡] [输入日课内容...    ] [×] │
│   ⚡ 点击配置自动规则（必需）      │
└────────────────────────────────────┘

再次点击图标（回到手动）：
┌────────────────────────────────────┐
│ 1 [🖐️] [输入日课内容...    ] [×] │
└────────────────────────────────────┘
```

---

### 2. 配置自动规则

**位置**：自动类型日课下方的蓝色/黄色框

**显示状态**：
- **未配置**：黄色背景，显示"点击配置自动规则（必需）"，带动画提示
- **已配置**：蓝色背景，显示规则摘要（如"#学习 时长 >= 240分钟"）

**交互方式**：
- 点击蓝色/黄色框，打开配置对话框
- 在对话框中设置筛选条件、判断类型、运算符、目标值
- 保存后，蓝色框显示配置的规则摘要

**示例**：
```
未配置状态：
┌────────────────────────────────────┐
│ 1 [⚡] [学习时长达标      ] [×]   │
│   ⚡ 点击配置自动规则（必需）      │ ← 黄色，带动画
└────────────────────────────────────┘

已配置状态：
┌────────────────────────────────────┐
│ 1 [⚡] [学习时长达标      ] [×]   │
│   ⚡ #学习 时长 >= 240分钟         │ ← 蓝色，可点击编辑
└────────────────────────────────────┘
```

---

## 完整操作流程

### 创建手动日课

```
1. 点击"添加项"
2. 默认是手动类型（手掌图标）
3. 输入日课内容
4. 完成
```

### 创建自动日课

```
1. 点击"添加项"
2. 点击手掌图标，切换为闪电图标
3. 输入日课名称（如"学习时长达标"）
4. 点击下方的黄色配置框
5. 在弹出的对话框中配置规则：
   - 筛选条件：#学习
   - 判断类型：总时长
   - 比较运算符：大于等于
   - 目标值：240
6. 保存配置
7. 下方显示蓝色规则摘要
8. 完成
```

### 修改自动规则

```
1. 找到已配置的自动日课
2. 点击下方的蓝色规则框
3. 在弹出的对话框中修改规则
4. 保存
5. 蓝色框更新为新的规则摘要
```

### 将自动切换为手动

```
1. 找到自动日课（闪电图标）
2. 点击闪电图标
3. 图标变为手掌，下方配置框消失
4. 自动配置被清除
```

### 将手动切换为自动

```
1. 找到手动日课（手掌图标）
2. 点击手掌图标
3. 图标变为闪电，下方出现黄色配置框
4. 点击配置框设置规则
```

---

## 视觉反馈

### 图标状态

| 状态 | 图标 | 背景色 | 说明 |
|------|------|--------|------|
| 手动 | 🖐️ | 灰色 | 需要手动勾选 |
| 自动 | ⚡ | 蓝色 | 自动判断完成 |

### 配置框状态

| 状态 | 背景色 | 文字色 | 动画 | 说明 |
|------|--------|--------|------|------|
| 未配置 | 黄色 | 琥珀色 | 脉动 | 提示需要配置 |
| 已配置 | 蓝色 | 蓝色 | 无 | 显示规则摘要 |

### 悬停效果

- **图标按钮**：悬停时背景色加深
- **配置框**：悬停时背景色加深，显示可点击
- **删除按钮**：悬停时显示，颜色变红

---

## 规则摘要格式

配置框中显示的规则摘要格式：

```
[筛选条件] [判断类型] [运算符] [目标值]
```

**示例**：

| 配置 | 显示 |
|------|------|
| 筛选：#学习<br>类型：总时长<br>运算符：>=<br>目标：240 | `#学习 时长 >= 240分钟` |
| 筛选：#起床<br>类型：最早开始<br>运算符：<=<br>目标：480 | `#起床 最早开始 <= 08:00` |
| 筛选：#运动<br>类型：次数<br>运算符：>=<br>目标：3 | `#运动 次数 >= 3次` |

---

## 注意事项

### 保存模板时的验证

- 自动类型的日课必须配置规则
- 如果有未配置的自动日课，保存时会提示错误
- 错误提示："有 X 个自动日课未配置规则，请点击配置按钮完成设置"

### 切换类型的影响

- **手动 → 自动**：保留日课名称，需要配置规则
- **自动 → 手动**：保留日课名称，清除自动配置

### 删除按钮

- 删除按钮始终在最右侧
- 不会被配置按钮挤出画面
- 鼠标悬停时才显示

---

## 键盘快捷键

| 操作 | 快捷键 |
|------|--------|
| 关闭配置对话框 | ESC |
| 保存配置 | 无（需点击按钮） |

---

## 常见问题

### Q: 为什么点击图标后没有打开配置对话框？
A: 点击图标只是切换类型，不会打开配置对话框。切换到自动后，点击下方的蓝色/黄色框才会打开配置对话框。

### Q: 如何知道自动日课是否已配置？
A: 看下方的配置框颜色：
- 黄色 = 未配置（带动画提示）
- 蓝色 = 已配置（显示规则摘要）

### Q: 可以不配置规则就保存吗？
A: 不可以。自动类型的日课必须配置规则，否则保存时会提示错误。

### Q: 切换类型会丢失配置吗？
A: 会。从自动切换到手动时，自动配置会被清除。

### Q: 如何快速切换多个日课的类型？
A: 逐个点击图标即可，每次点击都会立即切换。

---

## 设计理念

### 简洁性
- 使用图标代替下拉框，节省空间
- 一键切换类型，操作直观

### 清晰性
- 不同状态有明确的视觉反馈
- 未配置时有动画提示
- 已配置时显示规则摘要

### 一致性
- 所有自动日课使用相同的交互方式
- 配置对话框样式统一
- 视觉反馈一致

### 防错性
- 保存时验证自动日课是否已配置
- 切换类型时有明确的视觉变化
- 未配置时有明显的提示

---

## 总结

新的交互方式更加简洁和直观：
1. ✅ 图标切换代替下拉框
2. ✅ 点击配置框打开对话框
3. ✅ 删除按钮不会被挤出
4. ✅ 视觉反馈清晰
5. ✅ 操作流程简单
