# 自动日课使用指南

## 功能介绍

自动日课是一种智能的日课类型，它会根据你当天的活动记录自动判断完成状态，无需手动勾选。这对于需要量化追踪的习惯特别有用，比如：

- 学习时长达标
- 早起打卡
- 控制娱乐时间
- 运动时长统计

## 如何创建自动日课

### 1. 进入日课模板管理

设置 → 每日回顾 → 日课模板

### 2. 创建或编辑模板

点击"新建模板"或编辑现有模板

### 3. 添加日课项

在日课列表中，每个日课项都有类型选择：
- ✋ 手动：传统的手动勾选方式
- ⚡ 自动：根据规则自动判断

### 4. 配置自动规则

选择"自动"类型后，点击配置按钮（⚡ 图标）设置规则：

#### 4.1 筛选条件
使用筛选表达式指定要统计的活动：
- `#学习` - 包含"学习"标签的活动
- `%专业输入` - 属于"专业输入"领域的活动
- `@论文` - 关联"论文"待办的活动
- `#学习 %专业输入` - 同时满足多个条件

#### 4.2 判断类型
选择要统计的指标：
- **总时长**：统计匹配活动的总时长
- **最早开始时间**：统计最早的开始时间
- **最早结束时间**：统计最早的结束时间

#### 4.3 比较运算符
设置判断条件：
- 对于时长：`>=`（大于等于）、`<=`（小于等于）、`>`（大于）、`<`（小于）、`=`（等于）
- 对于时间：`>=`（不早于）、`<=`（不晚于）、`>`（晚于）、`<`（早于）、`=`（等于）

#### 4.4 目标值
- 时长类型：输入小时和分钟
- 时间类型：选择具体时刻

### 5. 保存配置

配置完成后，会显示规则预览，确认无误后保存。

## 使用示例

### 示例 1：每天学习 4 小时

**配置：**
- 日课名称：学习时长达标
- 筛选条件：`#学习 %专业输入`
- 判断类型：总时长
- 运算符：`>=`
- 目标值：4 小时 0 分钟

**效果：**
当天所有带"学习"标签或属于"专业输入"领域的活动总时长 ≥ 4 小时时，自动标记为完成。

### 示例 2：早起打卡（8点前起床）

**配置：**
- 日课名称：早起
- 筛选条件：`#起床`
- 判断类型：最早开始时间
- 运算符：`<=`（不晚于）
- 目标值：08:00

**效果：**
当天第一个"起床"活动的开始时间 ≤ 8:00 时，自动标记为完成。

### 示例 3：控制手机使用（不超过 2 小时）

**配置：**
- 日课名称：手机使用控制
- 筛选条件：`#手机 %娱乐`
- 判断类型：总时长
- 运算符：`<=`
- 目标值：2 小时 0 分钟

**效果：**
当天所有手机娱乐活动总时长 ≤ 2 小时时，自动标记为完成。

### 示例 4：晚上 10 点前结束工作

**配置：**
- 日课名称：按时下班
- 筛选条件：`#工作 %职业`
- 判断类型：最早结束时间
- 运算符：`<=`
- 目标值：22:00

**效果：**
当天最后一个工作活动的结束时间 ≤ 22:00 时，自动标记为完成。

## 在日报中查看

1. 打开任意日期的日报
2. 切换到"日课"标签
3. 自动日课会显示蓝色复选框和"自动"标签
4. 系统会根据当天的活动记录自动更新完成状态
5. 自动日课不能手动切换状态

## 数据统计

自动日课的完成情况会被纳入统计：

- **日课统计**：在数据统计页面查看完成率
- **完成趋势**：支持周/月/年视图
- **AI 叙事**：生成叙事时会包含自动日课的完成情况

## 注意事项

1. **更新时机**：自动日课在打开日课页面时更新，不是实时更新
2. **不可手动切换**：自动日课的完成状态由系统控制，不能手动勾选
3. **筛选语法**：使用与自定义筛选器相同的语法
4. **必须配置规则**：选择自动类型后必须配置规则，否则无法保存
5. **混合使用**：同一个模板中可以同时包含手动和自动日课

## 高级技巧

### 1. 组合条件

使用 OR 逻辑组合多个条件：
```
#学习 OR 阅读 %专业输入
```
表示：标签包含"学习"或"阅读"，且领域为"专业输入"

### 2. 多领域统计

```
%专业输入 OR 专业输出
```
统计多个领域的总时长

### 3. 排除特定活动

虽然不支持直接排除，但可以通过精确的筛选条件来实现：
```
#学习 %专业输入
```
只统计同时满足两个条件的活动

### 4. 时间段控制

结合"最早开始时间"和"最早结束时间"可以控制时间段：
- 早起：最早开始时间 <= 8:00
- 早睡：最早结束时间 <= 23:00

## 常见问题

### Q: 为什么自动日课没有更新？
A: 自动日课只在打开日课页面时更新。如果添加了新的活动记录，需要重新打开日课页面。

### Q: 可以修改自动日课的完成状态吗？
A: 不可以。自动日课的状态完全由系统根据规则判断，这样可以保证数据的客观性。

### Q: 筛选条件支持哪些语法？
A: 支持 # 标签、% 领域、@ 待办，以及 OR 逻辑。详细语法参考自定义筛选器文档。

### Q: 可以设置多个判断条件吗？
A: 目前每个自动日课只支持一个判断条件。如果需要多个条件，可以创建多个自动日课。

### Q: 自动日课会影响历史数据吗？
A: 不会。自动日课只影响新创建的日报。已有的日报中的日课保持原样。

## 最佳实践

1. **明确目标**：为每个自动日课设定清晰的目标，避免模糊的条件
2. **合理分组**：将相关的自动日课放在同一个模板中
3. **定期检查**：定期查看自动日课的完成情况，调整规则
4. **结合手动**：对于难以量化的习惯，使用手动日课
5. **循序渐进**：从简单的规则开始，逐步增加复杂度
